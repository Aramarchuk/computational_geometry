Script worked several ours and result was unexpected.
I will leave it here, because it looks funny.
Maybe I will fix it tomorrow.
